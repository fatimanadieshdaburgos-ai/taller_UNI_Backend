on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

env:
  NODE_VERSION: '20.x'

jobs:
  # TRABAJO 1: LINT (Verificar calidad de c√≥digo)
  lint:
    name: Lint Code
    runs-on: ubuntu-latest
    steps:
      
name: Checkout code
      uses: actions/checkout@v4
name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: ${{ env.NODE_VERSION }}
      cache: 'npm'
name: Install dependencies
  run: npm ci
name: Run ESLint
run: npm run lint

  # TRABAJO 2: BUILD (Compilar el proyecto)
  build:
    name: Build Application
    runs-on: ubuntu-latest
    needs: lint
    steps:
      
name: Checkout code
      uses: actions/checkout@v4
name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: ${{ env.NODE_VERSION }}
      cache: 'npm'
name: Install dependencies
  run: npm ci
name: Generate Prisma Client
run: npx prisma generate
name: Build project
run: npm run build

  # TRABAJO 3: TESTS (Pruebas unitarias)
  test:
    name: Run Tests
    runs-on: ubuntu-latest
    needs: build
    steps:
      
name: Checkout code
      uses: actions/checkout@v4
name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: ${{ env.NODE_VERSION }}
      cache: 'npm'
name: Install dependencies
  run: npm ci
name: Generate Prisma Client
run: npx prisma generate
name: Run unit tests
run: npm run test -- --passWithNoTests
